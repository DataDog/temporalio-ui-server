import{S as j,b as z,a as G,m as y,p as v,q as I,k as p,u as T,f as w,z as H,g as m,h as J,j as d,C as O,w as W,D as R,x as B,E as D,L as g,y as K,F as N,G as A,c as P,d as E,P as h,H as S,I as C,J as F}from"./index.9b814669.js";import{I as Y}from"./icon.951fea46.js";import{t as b}from"./translate.c28e5b4f.js";import{r as Q,a as k}from"./route-for-api.5de7e4eb.js";const U=o=>({}),L=o=>({}),q=o=>({}),V=o=>({});function M(o){let t,s,a,r;return s=new Y({props:{name:"merge"}}),{c(){t=y("span"),O(s.$$.fragment),a=W(o[2]),this.h()},l(i){t=v(i,"SPAN",{class:!0});var n=I(t);R(s.$$.fragment,n),a=B(n,o[2]),n.forEach(p),this.h()},h(){T(t,"class","version svelte-1b9fh62")},m(i,n){w(i,t,n),D(s,t,null),g(t,a),r=!0},p(i,n){(!r||n&4)&&K(a,i[2])},i(i){r||(d(s.$$.fragment,i),r=!0)},o(i){m(s.$$.fragment,i),r=!1},d(i){i&&p(t),N(s)}}}function X(o){let t,s,a,r,i,n;s=new Y({props:{name:"merge"}});const f=o[4]["overall-default-worker"],e=A(f,o,o[3],V),c=o[4]["default-worker"],u=A(c,o,o[3],L);return{c(){t=y("span"),O(s.$$.fragment),a=W(o[2]),r=P(),e&&e.c(),i=P(),u&&u.c(),this.h()},l(l){t=v(l,"SPAN",{class:!0});var _=I(t);R(s.$$.fragment,_),a=B(_,o[2]),r=E(_),e&&e.l(_),i=E(_),u&&u.l(_),_.forEach(p),this.h()},h(){T(t,"class","svelte-1b9fh62"),h(t,"active-version",o[1]),h(t,"version",!o[1])},m(l,_){w(l,t,_),D(s,t,null),g(t,a),g(t,r),e&&e.m(t,null),g(t,i),u&&u.m(t,null),n=!0},p(l,_){(!n||_&4)&&K(a,l[2]),e&&e.p&&(!n||_&8)&&S(e,f,l,l[3],n?F(f,l[3],_,q):C(l[3]),V),u&&u.p&&(!n||_&8)&&S(u,c,l,l[3],n?F(c,l[3],_,U):C(l[3]),L),(!n||_&2)&&h(t,"active-version",l[1]),(!n||_&2)&&h(t,"version",!l[1])},i(l){n||(d(s.$$.fragment,l),d(e,l),d(u,l),n=!0)},o(l){m(s.$$.fragment,l),m(e,l),m(u,l),n=!1},d(l){l&&p(t),N(s),e&&e.d(l),u&&u.d(l)}}}function Z(o){let t,s,a,r;const i=[X,M],n=[];function f(e,c){return e[0]&&e[2]?0:e[2]?1:-1}return~(s=f(o))&&(a=n[s]=i[s](o)),{c(){t=y("p"),a&&a.c(),this.h()},l(e){t=v(e,"P",{class:!0});var c=I(t);a&&a.l(c),c.forEach(p),this.h()},h(){T(t,"class","flex select-all gap-2 font-mono")},m(e,c){w(e,t,c),~s&&n[s].m(t,null),r=!0},p(e,[c]){let u=s;s=f(e),s===u?~s&&n[s].p(e,c):(a&&(H(),m(n[u],1,1,()=>{n[u]=null}),J()),~s?(a=n[s],a?a.p(e,c):(a=n[s]=i[s](e),a.c()),d(a,1),a.m(t,null)):a=null)},i(e){r||(d(a),r=!0)},o(e){m(a),r=!1},d(e){e&&p(t),~s&&n[s].d()}}}function $(o,t,s){let{$$slots:a={},$$scope:r}=t,{defaultVersion:i=!1}=t,{active:n=!1}=t,{buildId:f=""}=t;return o.$$set=e=>{"defaultVersion"in e&&s(0,i=e.defaultVersion),"active"in e&&s(1,n=e.active),"buildId"in e&&s(2,f=e.buildId),"$$scope"in e&&s(3,r=e.$$scope)},[i,n,f,r,a]}class ne extends j{constructor(t){super(),z(this,t,$,Z,G,{defaultVersion:0,active:1,buildId:2})}}async function oe(o,t=fetch){const s=Q("task-queue",o),a=await k(s,{request:t,params:{taskQueueType:"1"}}),r=await k(s,{request:t,params:{taskQueueType:"2"}});r.pollers.forEach(e=>{e.taskQueueTypes=["ACTIVITY"]}),a.pollers.forEach(e=>{e.taskQueueTypes=["WORKFLOW"]});const i=e=>(c,u)=>{const l=c[u.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return c[u.identity]={lastAccessTime:!l.lastAccessTime||l.lastAccessTime<u.lastAccessTime?u.lastAccessTime:l.lastAccessTime,taskQueueTypes:l.taskQueueTypes.concat([e])},c};r.pollers.filter(e=>a.pollers.some(c=>{if(e.identity===c.identity)return e.taskQueueTypes=[...c.taskQueueTypes,...e.taskQueueTypes],e})),r.pollers.reduce(i("ACTIVITY"),a.pollers.reduce(i("WORKFLOW"),{}));const n=r.pollers.length?r.pollers:a.pollers,f=r.pollers.length?r.taskQueueStatus:a.taskQueueStatus;return{pollers:n,taskQueueStatus:f}}async function re(o,t=fetch){const s=Q("task-queue.compatibility",o);return k(s,{request:t,onError:a=>console.error(a)})}async function le(o,t=fetch){const{namespace:s,buildIds:a,taskQueue:r}=o,i=Q("worker-task-reachability",{namespace:s}),n=new URLSearchParams;if(a.length)for(const f of a)n.append("buildIds",f);else n.append("buildIds",""),n.append("taskQueues",r);return await k(i,{request:t,params:n,onError:f=>(console.error(f),{buildIdReachability:[]})})}function x(o){return!o||!o.length?b("workers.ready-to-be-retired"):o.length===1&&o.includes("CLOSED")?b("common.maybe"):b("common.no")}function ie(o,t,s){var n,f;const a=(n=o==null?void 0:o.buildIdReachability)==null?void 0:n.find(e=>e.buildId===s);if(!a)return"";const r=(f=a==null?void 0:a.taskQueueReachability)==null?void 0:f.find(e=>(e==null?void 0:e.taskQueue)===t);if(!r)return"";const i=r==null?void 0:r.reachability;return x(i)}export{ne as C,re as a,le as b,ie as c,oe as g};
