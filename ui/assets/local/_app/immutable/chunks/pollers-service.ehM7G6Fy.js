import{s as j,e as y,b as v,d as I,g as p,j as T,k as Q,t as P,f as W,l as g,n as R,p as A,a as S,h as E,B as h,u as C,q as V,r as F}from"./scheduler.LRpOgQOC.js";import{S as D,i as U,g as z,b as m,e as G,t as d,c as q,a as B,m as K,d as N}from"./index.dE1eZLcR.js";import{I as Y}from"./icon.20MpH96w.js";import{t as b}from"./translate.HrioCK44.js";import{r as w,a as k}from"./route-for-api.rPK9t_O_.js";const H=r=>({}),L=r=>({}),J=r=>({}),O=r=>({});function M(r){let e,a,t,o;return a=new Y({props:{name:"merge"}}),{c(){e=y("span"),q(a.$$.fragment),t=P(r[2]),this.h()},l(i){e=v(i,"SPAN",{class:!0});var n=I(e);B(a.$$.fragment,n),t=W(n,r[2]),n.forEach(p),this.h()},h(){T(e,"class","version svelte-1qefyw")},m(i,n){Q(i,e,n),K(a,e,null),g(e,t),o=!0},p(i,n){(!o||n&4)&&R(t,i[2])},i(i){o||(d(a.$$.fragment,i),o=!0)},o(i){m(a.$$.fragment,i),o=!1},d(i){i&&p(e),N(a)}}}function X(r){let e,a,t,o,i,n;a=new Y({props:{name:"merge"}});const _=r[4]["overall-default-worker"],s=A(_,r,r[3],O),c=r[4]["default-worker"],u=A(c,r,r[3],L);return{c(){e=y("span"),q(a.$$.fragment),t=P(r[2]),o=S(),s&&s.c(),i=S(),u&&u.c(),this.h()},l(l){e=v(l,"SPAN",{class:!0});var f=I(e);B(a.$$.fragment,f),t=W(f,r[2]),o=E(f),s&&s.l(f),i=E(f),u&&u.l(f),f.forEach(p),this.h()},h(){T(e,"class","svelte-1qefyw"),h(e,"active-version",r[1]),h(e,"version",!r[1])},m(l,f){Q(l,e,f),K(a,e,null),g(e,t),g(e,o),s&&s.m(e,null),g(e,i),u&&u.m(e,null),n=!0},p(l,f){(!n||f&4)&&R(t,l[2]),s&&s.p&&(!n||f&8)&&C(s,_,l,l[3],n?F(_,l[3],f,J):V(l[3]),O),u&&u.p&&(!n||f&8)&&C(u,c,l,l[3],n?F(c,l[3],f,H):V(l[3]),L),(!n||f&2)&&h(e,"active-version",l[1]),(!n||f&2)&&h(e,"version",!l[1])},i(l){n||(d(a.$$.fragment,l),d(s,l),d(u,l),n=!0)},o(l){m(a.$$.fragment,l),m(s,l),m(u,l),n=!1},d(l){l&&p(e),N(a),s&&s.d(l),u&&u.d(l)}}}function Z(r){let e,a,t,o;const i=[X,M],n=[];function _(s,c){return s[0]&&s[2]?0:s[2]?1:-1}return~(a=_(r))&&(t=n[a]=i[a](r)),{c(){e=y("p"),t&&t.c(),this.h()},l(s){e=v(s,"P",{class:!0});var c=I(e);t&&t.l(c),c.forEach(p),this.h()},h(){T(e,"class","flex select-all gap-2 font-mono")},m(s,c){Q(s,e,c),~a&&n[a].m(e,null),o=!0},p(s,[c]){let u=a;a=_(s),a===u?~a&&n[a].p(s,c):(t&&(z(),m(n[u],1,1,()=>{n[u]=null}),G()),~a?(t=n[a],t?t.p(s,c):(t=n[a]=i[a](s),t.c()),d(t,1),t.m(e,null)):t=null)},i(s){o||(d(t),o=!0)},o(s){m(t),o=!1},d(s){s&&p(e),~a&&n[a].d()}}}function $(r,e,a){let{$$slots:t={},$$scope:o}=e,{defaultVersion:i=!1}=e,{active:n=!1}=e,{buildId:_=""}=e;return r.$$set=s=>{"defaultVersion"in s&&a(0,i=s.defaultVersion),"active"in s&&a(1,n=s.active),"buildId"in s&&a(2,_=s.buildId),"$$scope"in s&&a(3,o=s.$$scope)},[i,n,_,o,t]}class re extends D{constructor(e){super(),U(this,e,$,Z,j,{defaultVersion:0,active:1,buildId:2})}}async function oe(r,e=fetch){var s;const a=w("task-queue",r),t=await k(a,{request:e,params:{taskQueueType:"1"}}),o=await k(a,{request:e,params:{taskQueueType:"2"}});t!=null&&t.pollers||(t.pollers=[]),o!=null&&o.pollers||(o.pollers=[]),o.pollers.forEach(c=>{c.taskQueueTypes=["ACTIVITY"]}),t.pollers.forEach(c=>{c.taskQueueTypes=["WORKFLOW"]});const i=c=>(u,l)=>{const f=u[l.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return u[l.identity]={lastAccessTime:!f.lastAccessTime||f.lastAccessTime<l.lastAccessTime?l.lastAccessTime:f.lastAccessTime,taskQueueTypes:f.taskQueueTypes.concat([c])},u};o.pollers.filter(c=>t.pollers.some(u=>{if(c.identity===u.identity)return c.taskQueueTypes=[...u.taskQueueTypes,...c.taskQueueTypes],c})),(s=o.pollers)==null||s.reduce(i("ACTIVITY"),t.pollers.reduce(i("WORKFLOW"),{}));const n=o.pollers.length?o.pollers:t.pollers,_=o.pollers.length?o.taskQueueStatus:t.taskQueueStatus;return{pollers:n,taskQueueStatus:_}}async function le(r,e=fetch){const a=w("task-queue.compatibility",r);return k(a,{request:e,onError:t=>console.error(t)})}async function ie(r,e=fetch){const{namespace:a,buildIds:t,taskQueue:o}=r,i=w("worker-task-reachability",{namespace:a}),n=new URLSearchParams;if(t.length)for(const _ of t)n.append("buildIds",_);else n.append("buildIds",""),n.append("taskQueues",o);return await k(i,{request:e,params:n,onError:_=>(console.error(_),{buildIdReachability:[]})})}function x(r){return!r||!r.length?b("workers.ready-to-be-retired"):r.length===1&&r.includes("CLOSED")?b("common.maybe"):b("common.no")}function ue(r,e,a){var n,_;const t=(n=r==null?void 0:r.buildIdReachability)==null?void 0:n.find(s=>s.buildId===a);if(!t)return"";const o=(_=t==null?void 0:t.taskQueueReachability)==null?void 0:_.find(s=>(s==null?void 0:s.taskQueue)===e);if(!o)return"";const i=o==null?void 0:o.reachability;return x(i)}export{re as C,le as a,ie as b,ue as c,oe as g};
