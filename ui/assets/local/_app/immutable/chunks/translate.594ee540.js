import{S as M,b as q,a as B,C as E,D as F,E as G,j as h,g as k,F as N,m as X,p as Y,q as Z,k as w,u as x,f as g,z as Q,aa as $,ab as tt,h as D,K as I,a6 as et,a5 as S,e as p,n as W,G as nt,H as ot,I as st,J as rt,w as lt,x as at,y as ut}from"./index.9b814669.js";import{p as ct}from"./stores.8b6881b9.js";import{S as ft}from"./index.73889952.js";import{r as it,a as b,f as V}from"./workflows.7cb47a07.js";import{a as _t}from"./decode-payload.8339b61c.js";import{W as mt}from"./workflow-status.e2140907.js";import{t as dt}from"./translate.c28e5b4f.js";const j=(s,t,e)=>{const o=Math.pow(3600/s,1/e),l=s*Math.pow(o,t);return Math.min(3600,Math.round(l))};function ht(s){let t,e;return t=new mt({props:{count:s[1],newCount:s[2],status:s[0],"test-id":"workflow-status-"+s[0]}}),{c(){E(t.$$.fragment)},l(n){F(t.$$.fragment,n)},m(n,o){G(t,n,o),e=!0},p(n,[o]){const l={};o&2&&(l.count=n[1]),o&4&&(l.newCount=n[2]),o&1&&(l.status=n[0]),o&1&&(l["test-id"]="workflow-status-"+n[0]),t.$set(l)},i(n){e||(h(t.$$.fragment,n),e=!0)},o(n){k(t.$$.fragment,n),e=!1},d(n){N(t,n)}}}function kt(s,t,e){let{status:n}=t,{count:o=0}=t,{newCount:l=0}=t;return s.$$set=a=>{"status"in a&&e(0,n=a.status),"count"in a&&e(1,o=a.count),"newCount"in a&&e(2,l=a.newCount)},[n,o,l]}class pt extends M{constructor(t){super(),q(this,t,kt,ht,B,{status:0,count:1,newCount:2})}}function z(s,t,e){const n=s.slice();return n[18]=t[e].count,n[19]=t[e].status,n}function wt(s){let t,e;return t=new ft({props:{class:"h-6 w-24 rounded"}}),{c(){E(t.$$.fragment)},l(n){F(t.$$.fragment,n)},m(n,o){G(t,n,o),e=!0},p:W,i(n){e||(h(t.$$.fragment,n),e=!0)},o(n){k(t.$$.fragment,n),e=!1},d(n){N(t,n)}}}function gt(s){let t,e;function n(...l){return s[8](s[19],...l)}function o(...l){return s[9](s[19],...l)}return t=new pt({props:{status:s[19],count:s[18],newCount:s[1].find(n)?s[1].find(o).count-s[18]:0}}),{c(){E(t.$$.fragment)},l(l){F(t.$$.fragment,l)},m(l,a){G(t,l,a),e=!0},p(l,a){s=l;const u={};a&1&&(u.status=s[19]),a&1&&(u.count=s[18]),a&3&&(u.newCount=s[1].find(n)?s[1].find(o).count-s[18]:0),t.$set(u)},i(l){e||(h(t.$$.fragment,l),e=!0)},o(l){k(t.$$.fragment,l),e=!1},d(l){N(t,l)}}}function H(s,t){let e,n,o,l,a;const u=[gt,wt],r=[];function c(i,m){return i[2]?1:0}return n=c(t),o=r[n]=u[n](t),{key:s,first:null,c(){e=p(),o.c(),l=p(),this.h()},l(i){e=p(),o.l(i),l=p(),this.h()},h(){this.first=e},m(i,m){g(i,e,m),r[n].m(i,m),g(i,l,m),a=!0},p(i,m){t=i;let d=n;n=c(t),n===d?r[n].p(t,m):(Q(),k(r[d],1,1,()=>{r[d]=null}),D(),o=r[n],o?o.p(t,m):(o=r[n]=u[n](t),o.c()),h(o,1),o.m(l.parentNode,l))},i(i){a||(h(o),a=!0)},o(i){k(o),a=!1},d(i){i&&w(e),r[n].d(i),i&&w(l)}}}function yt(s){let t,e=[],n=new Map,o,l=s[0];const a=u=>u[19];for(let u=0;u<l.length;u+=1){let r=z(s,l,u),c=a(r);n.set(c,e[u]=H(c,r))}return{c(){t=X("div");for(let u=0;u<e.length;u+=1)e[u].c();this.h()},l(u){t=Y(u,"DIV",{class:!0});var r=Z(t);for(let c=0;c<e.length;c+=1)e[c].l(r);r.forEach(w),this.h()},h(){x(t,"class","flex min-h-[24px] flex-wrap items-center gap-2")},m(u,r){g(u,t,r);for(let c=0;c<e.length;c+=1)e[c].m(t,null);o=!0},p(u,[r]){r&7&&(l=u[0],Q(),e=$(e,r,a,1,u,l,n,t,tt,H,null,z),D())},i(u){if(!o){for(let r=0;r<l.length;r+=1)h(e[r]);o=!0}},o(u){for(let r=0;r<e.length;r+=1)k(e[r]);o=!1},d(u){u&&w(t);for(let r=0;r<e.length;r+=1)e[r].d()}}}const J=5,v=100;function bt(s,t,e){let n,o,l,a,u;I(s,it,f=>e(6,l=f)),I(s,b,f=>e(12,a=f)),I(s,ct,f=>e(7,u=f));let{staticQuery:r=""}=t,c=[],i=[],m,d=1,y=!1;et(()=>{A()});const K=()=>{if(d+=1,clearInterval(m),d<=v){const f=j(J,d,v)*1e3;m=setInterval(()=>T(),f)}},A=()=>{clearInterval(m),e(1,i=[]),S(b,a.newCount=0,a),d=1,e(2,y=!0)},P=(f=[])=>f.map(_=>{const C=_t(_==null?void 0:_.groupValues[0]),U=parseInt(_.count);return{status:C,count:U}}),T=async()=>{K();try{const{count:f,groups:_}=await V({namespace:n,query:o});S(b,a.newCount=parseInt(f)-a.count,a),e(1,i=P(_))}catch(f){console.error("Fetching workflow counts failed: ",f==null?void 0:f.message)}finally{e(2,y=!1)}},O=async()=>{A();const f=j(J,d,v)*1e3;m=setInterval(()=>T(),f);try{const{count:_,groups:C}=await V({namespace:n,query:o});S(b,a.count=parseInt(_),a),e(0,c=P(C))}catch(_){console.error("Fetching workflow counts failed: ",_==null?void 0:_.message)}finally{e(2,y=!1)}},L=(f,_)=>_.status===f,R=(f,_)=>_.status===f;return s.$$set=f=>{"staticQuery"in f&&e(3,r=f.staticQuery)},s.$$.update=()=>{s.$$.dirty&128&&e(4,n=u.params.namespace),s.$$.dirty&136&&e(5,o=r||u.url.searchParams.get("query")),s.$$.dirty&112&&O()},[c,i,y,r,n,o,l,u,L,R]}class Nt extends M{constructor(t){super(),q(this,t,bt,yt,B,{staticQuery:3})}}function Ct(s){let t;const e=s[5].default,n=nt(e,s,s[4],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,l){n&&n.m(o,l),t=!0},p(o,l){n&&n.p&&(!t||l&16)&&ot(n,e,o,o[4],t?rt(e,o[4],l,null):st(o[4]),null)},i(o){t||(h(n,o),t=!0)},o(o){k(n,o),t=!1},d(o){n&&n.d(o)}}}function It(s){let t;return{c(){t=lt(s[1])},l(e){t=at(e,s[1])},m(e,n){g(e,t,n)},p(e,n){n&2&&ut(t,e[1])},i:W,o:W,d(e){e&&w(t)}}}function St(s){let t,e,n,o;const l=[It,Ct],a=[];function u(r,c){return r[1]!==r[0]?0:1}return t=u(s),e=a[t]=l[t](s),{c(){e.c(),n=p()},l(r){e.l(r),n=p()},m(r,c){a[t].m(r,c),g(r,n,c),o=!0},p(r,[c]){let i=t;t=u(r),t===i?a[t].p(r,c):(Q(),k(a[i],1,1,()=>{a[i]=null}),D(),e=a[t],e?e.p(r,c):(e=a[t]=l[t](r),e.c()),h(e,1),e.m(n.parentNode,n))},i(r){o||(h(e),o=!0)},o(r){k(e),o=!1},d(r){a[t].d(r),r&&w(n)}}}function vt(s,t,e){let n,{$$slots:o={},$$scope:l}=t,{key:a}=t,{count:u=void 0}=t,{replace:r=void 0}=t;return s.$$set=c=>{"key"in c&&e(0,a=c.key),"count"in c&&e(2,u=c.count),"replace"in c&&e(3,r=c.replace),"$$scope"in c&&e(4,l=c.$$scope)},s.$$.update=()=>{s.$$.dirty&13&&e(1,n=dt(a,{count:u,...r}))},[a,n,u,r,l,o]}class Qt extends M{constructor(t){super(),q(this,t,vt,St,B,{key:0,count:2,replace:3})}}export{Qt as T,Nt as W};
