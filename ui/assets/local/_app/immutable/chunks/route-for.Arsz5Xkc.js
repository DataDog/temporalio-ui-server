import{B as X,O as B}from"./global.zYyA-D5k.js";import{c as G,g as Y}from"./_commonjsHelpers.4gQjN7DL.js";import{b as h}from"./paths.F1_pVtUN.js";import{e as x}from"./encode-uri.Mzeiosm2.js";var M={exports:{}};(function(e){(function(t,n){e.exports?e.exports=n():t.lscache=n()})(G,function(){var t="lscache-",n="-cacheexpiration",o=10,s=60*1e3,i=W(s),u,m,d="",D=!1;function w(){var r="__lscachetest__",a=r;if(u!==void 0)return u;try{if(!localStorage)return!1}catch{return!1}try{F(r,a),g(r),u=!0}catch(l){_(l)&&localStorage.length?u=!0:u=!1}return u}function _(r){return r&&(r.name==="QUOTA_EXCEEDED_ERR"||r.name==="NS_ERROR_DOM_QUOTA_REACHED"||r.name==="QuotaExceededError")}function A(){return m===void 0&&(m=window.JSON!=null),m}function Q(r){return r.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")}function I(r){return r+n}function N(){return Math.floor(new Date().getTime()/s)}function E(r){return localStorage.getItem(t+d+r)}function F(r,a){localStorage.removeItem(t+d+r),localStorage.setItem(t+d+r,a)}function g(r){localStorage.removeItem(t+d+r)}function U(r){var a=new RegExp("^"+t+Q(d)+"(.*)"),l=[],c,f;for(f=0;f<localStorage.length;f++)c=localStorage.key(f),c=c&&c.match(a),c=c&&c[1],c&&c.indexOf(n)<0&&l.push(c);for(f=0;f<l.length;f++)r(l[f],I(l[f]))}function C(r){var a=I(r);g(r),g(a)}function T(r){var a=I(r),l=E(a);if(l){var c=parseInt(l,o);if(N()>=c)return g(r),g(a),!0}}function R(r,a){D&&(!("console"in window)||typeof window.console.warn!="function"||(window.console.warn("lscache - "+r),a&&window.console.warn("lscache - The error was: "+a.message)))}function W(r){return Math.floor(864e13/r)}var q={set:function(r,a,l){if(!w()||!A())return!1;try{a=JSON.stringify(a)}catch{return!1}try{F(r,a)}catch(b){if(_(b)){var c=[],f;U(function(v,O){var S=E(O);S?S=parseInt(S,o):S=i,c.push({key:v,size:(E(v)||"").length,expiration:S})}),c.sort(function(v,O){return O.expiration-v.expiration});for(var L=(a||"").length;c.length&&L>0;)f=c.pop(),R("Cache is full, removing item with key '"+f.key+"'"),C(f.key),L-=f.size;try{F(r,a)}catch(v){return R("Could not add item with key '"+r+"', perhaps it's too big?",v),!1}}else return R("Could not add item with key '"+r+"'",b),!1}return l?F(I(r),(N()+l).toString(o)):g(I(r)),!0},get:function(r){if(!w()||T(r))return null;var a=E(r);if(!a||!A())return a;try{return JSON.parse(a)}catch{return a}},remove:function(r){w()&&C(r)},supported:function(){return w()},flush:function(){w()&&U(function(r){C(r)})},flushExpired:function(){w()&&U(function(r){T(r)})},setBucket:function(r){d=r},resetBucket:function(){d=""},getExpiryMilliseconds:function(){return s},setExpiryMilliseconds:function(r){s=r,i=W(s)},enableWarnings:function(r){D=r}};return q})})(M);var V=M.exports;const j=Y(V);class $ extends Error{}$.prototype.name="InvalidTokenError";function Z(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,n)=>{let o=n.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function K(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Z(t)}catch{return atob(t)}}function ee(e,t){if(typeof e!="string")throw new $("Invalid token specified: must be a string");t||(t={});const n=t.header===!0?0:1,o=e.split(".")[n];if(typeof o!="string")throw new $(`Invalid token specified: missing part #${n+1}`);let s;try{s=K(o)}catch(i){throw new $(`Invalid token specified: invalid base64 for part #${n+1} (${i.message})`)}try{return JSON.parse(s)}catch(i){throw new $(`Invalid token specified: invalid json for part #${n+1} (${i.message})`)}}const z=(e,t)=>{const n=t instanceof URLSearchParams;return t&&!n&&(t=new URLSearchParams(t)),t?`${e}?${t}`:e},ie=()=>`${h}/namespaces`,y=({namespace:e})=>`${h}/namespaces/${e}`,ue=()=>`${h}/select-namespace`,J=e=>`${y(e)}/workflows`,le=({namespace:e,query:t,search:n,page:o})=>z(J({namespace:e}),{query:t,search:n,...o&&{page:o}}),fe=e=>`${y(e)}/archival`,p=({workflow:e,run:t,...n})=>{const o=x(e);return`${J(n)}/${o}/${t}`},P=e=>`${y(e)}/schedules`,he=({namespace:e})=>`${P({namespace:e})}/create`,pe=({scheduleId:e,namespace:t})=>{const n=x(e);return`${P({namespace:t})}/${n}`},de=({scheduleId:e,namespace:t})=>{const n=x(e);return`${P({namespace:t})}/${n}/edit`},me=({queryParams:e,...t})=>{const n=`${p(t)}/history`;return z(`${n}`,e)},we=({eventId:e,...t})=>`${p(t)}/history/events/${e}`,ge=({eventId:e,...t})=>`${p(t)}/history/event-groups/${e}`,ve=e=>`${p(e)}/workers`,$e=e=>`${p(e)}/relationships`,Ie=e=>{const t=x(e.queue);return`${y({namespace:e.namespace})}/task-queues/${t}`},Se=e=>`${p(e)}/call-stack`,Ee=e=>`${p(e)}/query`,Fe=e=>`${p(e)}/metadata`,ke=e=>`${p(e)}/pending-activities`,xe=e=>{const{settings:t,searchParams:n,originUrl:o}=e;switch(t.auth.flow){case B.AuthorizationCode:default:return te(t,n,o);case B.Implicit:return re(t,n,o)}},te=(e,t,n)=>{const o=new URL(`${h}/auth/sso`,e.baseUrl);let s=e.auth.options??[];return s=[...s,"returnUrl"],s.forEach(i=>{if(!t)return;const u=t.get(i);u&&o.searchParams.set(i,u)}),!o.searchParams.get("returnUrl")&&n&&o.searchParams.set("returnUrl",n),o.toString()},re=(e,t,n)=>{const o=new URL(e.auth.authorizationUrl);o.searchParams.set("response_type","id_token"),o.searchParams.set("client_id",e.auth.clientId),o.searchParams.set("redirect_uri",n),o.searchParams.set("scope",e.auth.scopes.join(" "));const s=crypto.randomUUID();window.localStorage.setItem("nonce",s),o.searchParams.set("nonce",s);const i=crypto.randomUUID(),u=t.get("returnUrl")??window.location.href??"/";return j.set(`oidc.${i}`,u,10),o.searchParams.set("state",i),o.toString()};class k extends Error{}class ne extends k{}class H extends k{}const ye=e=>{const t=new URLSearchParams(e.substring(1)),n=t.get("id_token");if(!n)return null;if(!window.localStorage.getItem("nonce"))throw new ne("No nonce in localStorage");let s;try{s=ee(n)}catch(m){throw m instanceof $?new k("Invalid id_token in hash"):new k(m)}const i=t.get("state");if(!i)throw new H("No state in hash");const u=j.get(`oidc.${i}`);if(!u)throw new H("Hash state missing from localStorage");return{redirectUrl:u,authUser:{idToken:n,name:s.name,email:s.email},stateKey:i}},Ue=(e="",t=X)=>{if(t){const n=new URL(`${h}/login`,window.location.origin);return n.searchParams.set("returnUrl",window.location.href),e&&n.searchParams.set("error",e),n.toString()}return`${h}/login`},Ce=(e,t)=>e&&t?`${h}/import/events/${e}/workflow/run/history/${t}`:`${h}/import/events`,Re=({namespace:e})=>`${h}/namespaces/${e}/batch-operations`,be=({namespace:e,jobId:t})=>`${h}/namespaces/${e}/batch-operations/${t}`;export{re as A,fe as B,ie as C,ge as D,$ as I,k as O,y as a,me as b,Se as c,xe as d,J as e,ue as f,be as g,P as h,pe as i,Ue as j,Re as k,he as l,ve as m,$e as n,Ee as o,Fe as p,ke as q,Ce as r,ye as s,z as t,j as u,le as v,de as w,Ie as x,we as y,ee as z};
